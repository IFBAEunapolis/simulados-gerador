%Engine usada pelo AMC
%%AMC:latex_engine=lualatex

\documentclass[a4paper,twoside]{article}
\usepackage{multiplechoiceifba}
\usepackage{pgffor}
\usepackage{csvsimple}
\usepackage{etoolbox}
\usepackage{luacode}
\usepackage{import}

% 
\import{Atividades/}{config}

\begin{luacode}
function splitgroup(disciplinas)
	for disc in string.gmatch(disciplinas, '[^;]+') do
		local fileHandler = io.open("Atividades/" .. disc .. ".tex","r")
		if fileHandler then
			fileHandler:close()
			tex.print("\\shufflegroup{" .. disc .. "}")
			tex.print("\\insertgroup{" .. disc .. "}")
		end
	end	
end
\end{luacode}
\def\AMCbeginQuestion#1#2{\par\noindent{\bf #1 )} #2\hspace*{1pt}}
\newcommand{\duracao}{140 minutos}
\newcommand{\subject}{
	\onecopy{1}{  
		\noindent
		\input{Atividades/cabecalho}
		\input{Atividades/orientacoes}
		\vfill

		\directlua{splitgroup("\disciplinas")}
  
	    \AMCassociation{\id}
	    \cleardoublepage
	    
	    % Foreach da quantidade de disciplinas
	}

}
%%% preparation of the groups
\include{Atividades/POO001}
\include{Atividades/ILP001}
\include{Atividades/POO002}
% \include{Atividades/lista}
\renewcommand{\lstlistingname}{}

\begin{document}

\AMCrandomseed{1237893}

\csvreader[head to column names]{arquivos/alunos.csv}{}{\subject}

\end{document}
